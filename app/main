module Main where

import Lib
import Language.Fortran.PrettyPrint
import Language.Fortan.AST
import Language.Fortran.Parser.Fortran90
import System.Environment
import Debug.Trace

main :: IO ()
main = do
  [fn] <- getArgs
  fc <- readFile fn
  -- TODO update to call the right parser
  let java = case parser compilationUnit fc
               of Right pt -> pt
                  _ -> trace fn $ CompilationUnit Nothing [] []
      res = testj java
      ms = concatMap ((++ "haha \n") . prettyPrint) $ res
      out = fn ++ "\n" ++ ms ++ "matches" ++ (show $ length res) ++ "\n"
  -- print 
  if length res > 0 then putStr out else return ()
  -- print $ length res
  -- print . map prettyPrint $ tests
  -- print $ length tests
  -- print tests
  -- print prog1
  -- print "pretty print"
  -- putStrLn $ prettyPrint prog1
  -- print . map prettyPrint $ reps prog1 f
